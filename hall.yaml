esphome:
  name: hall
  platformio_options:
    board_build.f_cpu: 80000000L
  includes:
    - http_sensor_idf.h

esp32:
  board: esp32dev
  framework:
    type: esp-idf
    platform_version: 5.4.0
    version: 4.4.5

wifi:
  ssid: !secret wifi_ssid_home
  password: !secret wifi_password_home
  reboot_timeout: 0s
  ap:
    ssid: "hall"
    password: !secret ap_password
    ap_timeout: 20s
#  power_save_mode: HIGH

#captive_portal:

# Enable logging
logger:
  level: VERBOSE
  #level: VERY_VERBOSE
  #level: INFO

# Enable Home Assistant API
api:
  reboot_timeout: 0s

ota:

# Активация web сервера
web_server:
  port: 80
  #  local: true
  ota: false
  version: 2
  js_include: "www.js"
  js_url: ""

#status_led:
#  pin:
#    number: GPIO2
#    inverted: false

binary_sensor:
  - platform: gpio
    pin:
      number: GPIO0
      inverted: true
    filters:
      - delayed_on: 50ms
    name: "Boot button"

# Individual sensors
sensor:
  - platform: uptime
    name: Uptime Sensor
    update_interval: 5min

  - platform: esp32_hall
    name: "ESP32 Hall Sensor"
    update_interval: 100s

  - platform: custom
    lambda: |-
      auto http_sensor1 = new HTTPSensor("http://192.168.10.1", "StatusSNS.DHT11.Temperature;StatusSNS.DHT11.Humidity");
      http_sensor1->set_update_interval(10000);
      App.register_component(http_sensor1);
      return {http_sensor1->sensors_array[0], http_sensor1->sensors_array[1]};
    sensors:
      - name: "Remote Temperature Sensor"
        unit_of_measurement: °C
        accuracy_decimals: 1
      - name: "Remote Humidity Sensor"
        unit_of_measurement: h
        accuracy_decimals: 0

  - platform: custom
    lambda: |-
      auto http_sensor2 = new HTTPSensor("http://192.168.10.2", "StatusSNS.DHT11.Temperature2;StatusSNS.DHT11.Humidity2;StatusSNS.DHT11.Humidity3");
      http_sensor2->set_update_interval(12000);
      App.register_component(http_sensor2);
      return {http_sensor2->sensors_array[0], http_sensor2->sensors_array[1], http_sensor2->sensors_array[1]};
    sensors:
      - name: "Remote Temperature Sensor2"
        unit_of_measurement: °C
        accuracy_decimals: 1
      - name: "Remote Humidity Sensor2"
        unit_of_measurement: h
        accuracy_decimals: 0
      - name: "Remote Humidity Sensor3"
        unit_of_measurement: h
        accuracy_decimals: 0
    
select:
  - platform: template
    name: Mode
    id: mode
    options:
      - "Option1"
      - "Option2"
      - "Option3"
    #    initial_option: "OFF"
    optimistic: true
    set_action:
      - logger.log:
          format: "Chosen option: %s"
          args: ["x.c_str()"]

lock:
  - platform: template
    name: Lock comp
    optimistic: true
    on_lock:
      - logger.log: "Door Locked!"
    on_unlock:
      - logger.log: "Door Unlocked!"

font:
  - file: "fonts/tahomabd.ttf"
    id: tahoma_clock
    size: 80
  - file: "fonts/tahomabd.ttf"
    id: tahoma_16
    size: 16

spi:
  clk_pin: GPIO14
  mosi_pin: GPIO13

display:
  - platform: st7567
    cs_pin: GPIO15
    dc_pin: GPIO27
    reset_pin: GPIO26
    lambda: |-
      it.line(0, 0, 127, 63);
      it.circle(64, 32, 20);
